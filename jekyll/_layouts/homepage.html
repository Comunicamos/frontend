---
layout: base
---

<script type="text/javascript">

    // UTIL
    //-------------
    var render = function (fn) {
        fn();
    };

    function scrollTop(val) {
        if (val === undefined) {
            return window.pageYOffset;
        } else {
            document.body.scrollTop = val;
            document.documentElement.scrollTop = val;
        }
    }

    var isHandheld = (function() {
        return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
    })();

    var isIE = (function() {
        return /MSIE/.test(navigator.userAgent);
    })();

    function removeClass(el, className) {
        if (el.classList) {
            el.classList.remove(className);
        } else {
            el.className = el.className.replace(new RegExp('(^|\\b)' + className.split(' ').join('|') + '(\\b|$)', 'gi'), ' ')
        }
    }

    function addClass(el, className) {
        if (el.classList) {
            el.classList.add(className);
        } else {
            el.className += ' ' + className;
        }
    }

    // INIT FUNCS
    //------------------------

    function initVideo() {
        var videoEls = document.querySelectorAll('.nxt-speedcurve__video');
        document.addEventListener('scroll', function() {
            Array.prototype.forEach.call(videoEls, function(videoEl) {
                var top = videoEl.getBoundingClientRect().top;
                if (top !== 0 && top < 300) { videoEl.play(); }
            })
        });

        if (isHandheld) {
            Array.prototype.forEach.call(
                document.querySelectorAll('video'),
                function(el){ el.setAttribute('controls', 'true'); });
        }

    }

    function initSmoothScroll() {
        // this is to smooth out mousewheel style coarse scrolls (better for parallax / animations)
        // should probably skip it on OSX and touch devices
        var interval,
                toMove = 0;

        function handleScroll(e) {
            var delta;
            if (e.type == 'mousewheel') {
                delta = (e.wheelDelta * -1);
            } else {
                delta = 40 * e.detail;
            }

            toMove += delta * 0.5;
            if (!interval) {
                var last = new Date();
                var move = function () {
                    var now = new Date(),
                            dt = now - last,
                            perc = (dt / 100) * 0.99, // 98% towards target every 100ms
                            moveAmount = toMove * perc;
                    toMove -= moveAmount;
                    scrollTop(scrollTop() + moveAmount);
                    if (Math.abs(toMove) < 20) {
                        clearInterval(interval);
                        interval = false;
                    }
                    last = now;
                };
                interval = setInterval(move, 10);
            }

            e.preventDefault();

        }

        document.addEventListener('mousewheel', handleScroll);
        document.addEventListener('DOMMouseScroll', handleScroll);
    }

    function initSlideshow() {
        var current = 1,
                classPrefix = 'nxt-backgrounds--',
                bgEl = document.querySelector('.nxt-backgrounds');

        function next() {
            removeClass(bgEl, classPrefix + current);
            current = current === 3 ? 1 : ++current;
            addClass(bgEl, classPrefix + current);
        }

        window.setInterval(next, 4000);
    }

    function initParallax() {
        if (!isIE && !isHandheld) {
            var parallax = new Parallax(parallaxSpec);
            window.parallax = parallax;
            function updateBasedonWidth() {
                if (window.innerWidth < 740) {
                    addClass(document.querySelector('.nxt-container--content'), 'nxt-container--content-stacked');
                    parallax.enabled && parallax.disable();
                } else {
                    removeClass(document.querySelector('.nxt-container--content'), 'nxt-container--content-stacked');
                    !parallax.enabled && parallax.enable();
                }
            }
            window.addEventListener('resize', updateBasedonWidth);
            updateBasedonWidth();
            document.addEventListener('scroll', function(e) {
                e.preventDefault();
            });
        }
    }

    // PARALLAX SPEC
    //-----------------------------

    var parallaxSpec = function() {
        var contentEl = null;
        function topOfContent() {
            contentEl = contentEl || document.querySelector('.nxt-container--content');
            return -1 * contentEl.getBoundingClientRect().top;
        }
        return {
            '.nxt-container--top .nxt-backgrounds': {
                transform: {top: 0, bottom: 800, from: -10, to: 35, prefix: 'translateY(', suffix: '%)'}
            },
            '.nxt-container--top .nxt-copy': {
                opacity: {top: 300, bottom: 800, from: 1.0, to: 0.0}
            },
            '.nxt-container--top .nxt-copy h2': {
                lineHeight: {top: 300, bottom: 900, from: 48, to: 82, suffix: 'px'},
                marginTop: {top: 300, bottom: 900, from: 0, to: 5, suffix: '%'}
            },
            '.nxt-container--top .nxt-copy p': {
                lineHeight: {top: 300, bottom: 900, from: 22, to: 45, suffix: 'px'}
            },
            '.nxt-after-content': {
                transform: {measure: topOfContent, top: 0, bottom: 1800, from: -1800, to: 0, prefix: 'translateY(', suffix: 'px)'}
            },
            '.nxt-container--content .nxt-copy': {
                transform: {measure: topOfContent, top: 0, bottom: 1800, from: 0, to: 1800, prefix: 'translateY(', suffix: 'px)'}
            },
            '.nxt-copy--articles': {
                opacity: {measure: topOfContent, top: 400, bottom: 500, from: 0, to: 1, hide: true}
            },
            '.nxt-copy--galleries': {
                opacity: {measure: topOfContent, top: 850, bottom: 950, from: 0, to: 1, hide: true}
            },
            '.nxt-copy--liveblogs': {
                opacity: {measure: topOfContent, top: 1300, bottom: 1400, from: 0, to: 1, hide: true}
            },
            '.nxt-laptop': {
                transform: {measure: topOfContent, top: 0, bottom: 1800, from: 0, to: 1800, prefix: 'translateY(', suffix: 'px)'}
            },
            '.nxt-laptop__grab--fronts': {
                transform: {measure: topOfContent, top: 100, bottom: 450, from: 0, to: -50, prefix: 'translateY(', suffix: '%)'}
            },
            '.nxt-laptop__grab--articles': {
                transform: {measure: topOfContent, top: 600, bottom: 950, from: 0, to: -50, prefix: 'translateY(', suffix: '%)'},
                opacity: {measure: topOfContent, top: 400, bottom: 500, from: 0, to: 1, hide: true}
            },
            '.nxt-laptop__grab--media': {
                transform: {measure: topOfContent, top: 1050, bottom: 1400, from: 0, to: -50, prefix: 'translateY(', suffix: '%)'},
                opacity: {measure: topOfContent, top: 850, bottom: 950, from: 0, to: 1, hide: true}
            },
            '.nxt-laptop__grab--liveblogs': {
                transform: {measure: topOfContent, top: 1500, bottom: 1800, from: 0, to: -50, prefix: 'translateY(', suffix: '%)'},
                opacity: {measure: topOfContent, top: 1300, bottom: 1400, from: 0, to: 1, hide: true}
            }
        };
    }();

    // PARALLAX CODE
    //----------------------------

    function Parallax(spec) {
        this.parallaxEls = {};
        this.parallaxSpec = spec;
        this.enabled = true;
        this.needsReset = false;
        for (var selector in this.parallaxSpec) { // pre-select elements
            this.parallaxEls[selector] = Array.prototype.slice.call(document.querySelectorAll(selector));
        }
        this.init();
    }

    Parallax.prototype.init = function() {
        document.addEventListener('scroll', this.update.bind(this));
        this.update();
    };

    Parallax.prototype.disable = function() {
        this.enabled = false;
        this.needsReset = true;
        this.update();
    };

    Parallax.prototype.enable = function() {
        this.enabled = true;
        this.needsReset = false;
        this.update();
    };

    Parallax.prototype.update = function() {
        if (this.enabled || this.needsReset) {
            for (var selector in parallaxSpec) {
                var props = parallaxSpec[selector];
                for (var prop in props) {
                    var p = props[prop],
                            value;
                    if (typeof p === 'function') {
                        value = p();
                    } else {
                        var _scrollTop = p.measure ? p.measure() : scrollTop(),
                            progress, newVal, value;
                        if (!this.enabled) {
                            value = '';
                            this.needsReset = false;
                        } else {
                            if (_scrollTop < p.top) { progress = 0; }
                            else if (p.top < _scrollTop && _scrollTop < p.bottom) {
                                progress = (_scrollTop - p.top) / (p.bottom - p.top);
                            }
                            else if (_scrollTop > p.bottom) { progress = 1; }
                            newVal = p.from + (progress * (p.to - p.from));
                            value = (p.prefix || '') + newVal + (p.suffix || '');
                        }
                    }
                    render(function (els, prop, val, spec) {
                        els.forEach(function (el) {
                            el.style[prop] = val;
                            if (spec.hide) {
                                el.style.display = prop === 'opacity' && parseFloat(val, 10) === 0.0 ? 'none' : '';
                            }
                        })
                    }.bind(undefined, this.parallaxEls[selector], prop, value, p));
                }
            }
        }
    };

    function initCompatibility() {
        if (isIE) { addClass(document.body, 'is-ie'); }
    }

    document.addEventListener('DOMContentLoaded', function () {
        initCompatibility();
        initSmoothScroll();
        initParallax();
        initSlideshow();
        initVideo();

        if(isHandheld) {
            addClass(document.body.querySelector('.main-body-container'),'nxt-handheld');
        }
    });
</script>

<div class="main-body-container">

    <div class="nxt-container nxt-container--top">
        <div class="nxt-body    ">
            <div class="nxt-parallax-container">
                <div class="nxt-backgrounds">
                    <div></div>
                    <div></div>
                    <div></div>
                </div>
                <div class="nxt-copy">
                    <h2>{{ page.sections.top.title }}</h2>
                    <p>{{ page.sections.top.text }}</p>
                </div>
            </div>
        </div>
    </div>

    <div class="nxt-container nxt-container--content nxt-container--content-stacked">
        <div class="nxt-body">
            <div class="nxt-copy nxt-copy--fronts">
                <h2>{{ page.sections.fronts.title }}</h2>
                <img src="/assets/images/homepage/laptop_mobile_front.png">
                <p>{{ page.sections.fronts.text }}</p>
            </div>
            <div class="nxt-copy nxt-copy--articles">
                <h2>{{ page.sections.article.title }}</h2>
                <img src="/assets/images/homepage/laptop_mobile_article.png">
                <p>{{ page.sections.article.text }}</p>
            </div>
            <div class="nxt-copy nxt-copy--galleries">
                <h2>{{ page.sections.galleries.title }}</h2>
                <img src="/assets/images/homepage/laptop_mobile_gallery.png">
                <p>{{ page.sections.galleries.text }}</p>
            </div>
            <div class="nxt-copy nxt-copy--liveblogs">
                <h2>{{ page.sections.liveblog.title }}</h2>
                <img src="/assets/images/homepage/laptop_mobile_live.png">
                <p>{{ page.sections.liveblog.text }}</p>
            </div>
            <div class="nxt-laptop">
                <img class="nxt-laptop__screen" src="/assets/images/homepage/laptop_cutout.png">
                <img class="nxt-laptop__grab nxt-laptop__grab--fronts" src="/assets/images/homepage/grab_front.jpg">
                <img class="nxt-laptop__grab nxt-laptop__grab--articles" src="/assets/images/homepage/grab_article.jpg">
                <img class="nxt-laptop__grab nxt-laptop__grab--media" src="/assets/images/homepage/grab_gallery.jpg">
                <img class="nxt-laptop__grab nxt-laptop__grab--liveblogs" src="/assets/images/homepage/grab_liveblog.jpg">
            </div>
        </div>
    </div>

    <div class="nxt-after-content">

        <div class="nxt-container nxt-container--performance">
            <div class="nxt-body">
                <div class="nxt-copy">
                    <h2>{{ page.sections.performance.title }}</h2>
                    <video class="nxt-speedcurve__video nxt-speedcurve__video--mobile" preload >
                        <source type="video/mp4" src="/assets/videos/speedtest_mobile.mp4" >
                        <source type="video/webm" src="/assets/videos/speedtest_mobile.webm" >
                    </video>
                    <p>{{ page.sections.performance.text }}</p>
                </div>
                <div class="nxt-speedcurve u-cf">
                    <div class="nxt-speedcurve__container">
                        <video class="nxt-speedcurve__video nxt-speedcurve__video--desktop" preload>
                            <source type="video/mp4" src="/assets/videos/speedtest.mp4" >
                            <source type="video/webm" src="/assets/videos/speedtest.webm" >
                        </video>
                        <img class="nxt-speedcurve__screenshot" src="/assets/images/homepage/speedtest_desktop.png" alt="speedcurve comparison">
                    </div>
                </div>
                <div class="u-cf"></div>
            </div>
        </div>

        <div class="nxt-container nxt-container--sharing u-cf">
            <div class="nxt-body">
                <div class="nxt-sharing-img--icons">
                    <img src="/assets/images/homepage/shareicons.png">
                </div>
                <div class="nxt-copy">
                    <h2>{{ page.sections.sharing.title }}</h2>
                    <p>{{ page.sections.sharing.text }}</p>
                </div>
                <div class="nxt-sharing-img--selectnshare">
                    <img src="/assets/images/homepage/selectnshare.png">
                </div>
            </div>
        </div>

        <div class="nxt-container nxt-container--open">
            <div class="nxt-body u-cf">
                <div class="nxt-copy">
                    <h2>{{ page.sections.open.title }}</h2>
                    <img class="nxt-open-img--mobile" src="/assets/images/homepage/workin.jpg" alt="developed in the open">
                    <p>{{ page.sections.open.text }}</p>
                </div>
                <img class="nxt-open-img--desktop" src="/assets/images/homepage/workin.jpg" alt="developed in the open">
            </div>
        </div>

    </div>

</div>
